<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Belajar Laravel</title>

    <link rel="stylesheet" href="css/index.css">
</head>
<body>
    <div class="container">
        <aside id="aside">

        </aside>
        <main>
            <header>
                
            </header>

            <div class="content">
<pre>
    ğŸ‘‰ 3ï¸âƒ£ Token Authentication (Sanctum)

    Kalau tadi kita sudah punya:

    REST API âœ…

    API Resource âœ…

    Sekarang pertanyaannya:

    Gimana caranya user login di API?

    Karena di API kita tidak pakai session seperti web biasa.

    
    
    
    
    
    
    
    ğŸ§  Masalah di API

    Di web biasa:

    User login

    Laravel simpan session

    Browser simpan cookie

    User dianggap login

    Tapi di API:

    âŒ Tidak ada session
    âŒ Tidak pakai cookie
    âŒ Stateless

    Maka solusinya adalah:

    ğŸ” Token Authentication

    
    
    
    
    
    
    
    ğŸ”¥ Apa Itu Token?

    Token adalah:

    Kode unik yang diberikan saat login dan dikirim di setiap request.

    Alurnya:

    Login
    â†“
    Server kasih token
    â†“
    Client simpan token
    â†“
    Setiap request kirim token
    â†“
    Server validasi token


    Kalau valid â†’ akses diizinkan.

    
    
    
    
    
    
    
    ğŸ›¡ Kenapa Pakai Sanctum?

    Laravel menyediakan package resmi:

    ğŸ§© Laravel Sanctum

    Sanctum digunakan untuk:

    API token authentication

    SPA authentication

    Mobile authentication

    Dan lebih ringan dibanding Passport.

    
    
    
    
    
    
    
    ğŸ›  Cara Install Sanctum
    1ï¸âƒ£ Install Package
    composer require laravel/sanctum

    2ï¸âƒ£ Publish Config & Migration
    php artisan vendor:publish --provider="Laravel\Sanctum\SanctumServiceProvider"

    3ï¸âƒ£ Migrate
    php artisan migrate


    Ini akan buat tabel:

    personal_access_tokens

    4ï¸âƒ£ Tambahkan Trait di Model User

    Di User.php:

    use Laravel\Sanctum\HasApiTokens;

    class User extends Authenticatable
    {
        use HasApiTokens;
    }


    Ini wajib ğŸ”¥

    
    
    
    
    
    
    
    ğŸ” Cara Login & Generate Token
    Contoh Login API
    public function login(Request $request)
    {
        if (!Auth::attempt($request->only('email', 'password'))) {
            return response()->json([
                'message' => 'Login gagal'
            ], 401);
        }

        $user = Auth::user();

        $token = $user->createToken('api-token')->plainTextToken;

        return response()->json([
            'token' => $token,
            'user' => $user
        ]);
    }


    Boom ğŸ’¥
    User dapat token.

    ğŸ§  Contoh Token yang Dihasilkan
    1|fghjk56789asdfghjk98765


    Client harus simpan token ini.

    
    
    
    
    
    
    
    ğŸ”¥ Cara Kirim Token di Request

    Di frontend / Postman, tambahkan header:

    Authorization: Bearer TOKEN_KAMU


    Contoh:

    Authorization: Bearer 1|fghjk56789asdfghjk98765

    
    
    
    
    
    
    
    ğŸ”’ Protect Route dengan Sanctum

    Di api.php:

    Route::middleware('auth:sanctum')->get('/profile', function (Request $request) {
        return $request->user();
    });


    Sekarang:

    Kalau tidak kirim token â†’ 401

    Kalau token valid â†’ boleh masuk

    
    
    
    
    
    
    
    ğŸ§  Logout API

    Untuk hapus token:

    public function logout(Request $request)
    {
        $request->user()->currentAccessToken()->delete();

        return response()->json([
            'message' => 'Logout berhasil'
        ]);
    }


    Token dihapus â†’ tidak bisa dipakai lagi.

    
    
    
    
    
    
    
    ğŸ”¥ Multiple Device Login

    Sanctum bisa buat banyak token:

    $user->createToken('mobile-token');
    $user->createToken('web-token');


    Jadi bisa login di:

    Mobile

    Web

    Tablet

    Semua beda token.

    
    
    
    
    
    
    
    ğŸ§  Flow Lengkap Sanctum

    1ï¸âƒ£ User register
    2ï¸âƒ£ User login
    3ï¸âƒ£ Server kirim token
    4ï¸âƒ£ Frontend simpan token
    5ï¸âƒ£ Setiap request kirim header Bearer
    6ï¸âƒ£ Middleware auth:sanctum cek token

    Stateless & aman ğŸ”

    
    
    
    
    
    
    
    ğŸ¯ Kapan Pakai Sanctum?

    Gunakan Sanctum untuk:

    âœ… SPA (Vue/React)
    âœ… Mobile app
    âœ… REST API
    âœ… Token sederhana
    âœ… SaaS

    Kalau butuh OAuth kompleks â†’ baru pakai Passport.

    
    
    
    
    
    
    
    âš  Kesalahan Umum Pemula

    âŒ Lupa pakai HasApiTokens
    âŒ Lupa pakai auth:sanctum
    âŒ Tidak kirim Bearer token
    âŒ Masih pakai session di API
    âŒ Tidak hash password saat register

    
    
    
    
    
    
    
    ğŸ Kesimpulan

    Sanctum adalah:

    ğŸ” Sistem login berbasis token
    ğŸš€ Ringan & simple
    ğŸ“± Cocok untuk SPA & mobile
    ğŸ›¡ Standar keamanan API Laravel

    Sekarang API kamu sudah:

    RESTful âœ…

    Rapi (Resource) âœ…

    Aman (Sanctum) âœ…

    Sudah level production ğŸ”¥
</pre>

            </div>
        </main>
    </div>
    <script>
        fetch('layout/aside.html').then( response => response.text()).then( data => {
            document.getElementById('aside').innerHTML = data;

            const currentPage = window.location.pathname.split('/').pop() || 'index.html';
            const links = document.querySelectorAll('aside a');

            links.forEach(link => {
                if(currentPage == 'index.html'){
                    document.getElementById('1-1-php-dasar').classList.add('active');
                } else if(link.getAttribute('href') == currentPage){
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>