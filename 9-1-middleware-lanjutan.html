<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Belajar Laravel</title>

    <link rel="stylesheet" href="css/index.css">
</head>
<body>
    <div class="container">
        <aside id="aside">

        </aside>
        <main>
            <header>
                
            </header>

            <div class="content">
<pre>
    ğŸš€ BAB 9: Advanced Laravel

    Ini bab yang bikin kamu naik dari intermediate â†’ advanced.

    Kalau sebelumnya kita belajar:

    Auth

    Authorization

    File upload

    Storage

    Soft delete

    Sekarang kita masuk ke arsitektur dalam Laravel.

    Dan kita mulai dari:

    
    
    
    
    
    
    
    ğŸ‘‰ 1ï¸âƒ£ Middleware Lanjutan

    Tenang bro, kita bahas pelan-pelan dan super jelas ğŸ‘Œ

    
    
    
    
    
    
    
    ğŸ§  Recap Dulu: Middleware Itu Apa?

    Middleware itu seperti satpam di pintu.

    Alurnya:

    Request masuk
    â†“
    Middleware cek dulu
    â†“
    Kalau lolos â†’ Controller jalan
    Kalau gagal â†’ ditolak


    Contoh basic:

    Route::get('/dashboard', ...)
        ->middleware('auth');


    Artinya:
    Kalau belum login â†’ tidak boleh masuk.

    
    
    
    
    
    
    
    ğŸ”¥ Sekarang: Middleware Lanjutan Itu Apa?

    Middleware lanjutan artinya kita mulai memahami:

    Cara kerja internal middleware

    Parameter middleware

    Multiple middleware

    Global middleware

    Middleware priority

    Terminable middleware

    Kita kupas satu-satu.

    
    
    
    
    
    
    
    ğŸ§± 1ï¸âƒ£ Struktur Dasar Middleware

    File middleware ada di:

    app/Http/Middleware/


    Contoh:

    public function handle($request, Closure $next)
    {
        // logic sebelum controller

        return $next($request);

        // logic sesudah controller
    }

    
    
    
    
    
    
    
    ğŸ§  Pahami $next($request)

    Ini sangat penting.

    Bayangkan seperti ini:

    Middleware A
        â†“
    Middleware B
        â†“
    Controller


    Kalau kamu tidak panggil:

    return $next($request);


    Maka request berhenti di middleware itu.

    
    
    
    
    
    
    
    ğŸ”¥ 2ï¸âƒ£ Middleware Dengan Logic Sebelum & Sesudah

    Contoh:

    public function handle($request, Closure $next)
    {
        logger('Request masuk');

        $response = $next($request);

        logger('Response keluar');

        return $response;
    }


    Artinya:

    Sebelum controller â†’ log

    Setelah controller â†’ log lagi

    Middleware bisa kerja di dua sisi ğŸ”¥

    
    
    
    
    
    
    
    ğŸ§± 3ï¸âƒ£ Middleware Dengan Parameter

    Ini yang mulai advanced.

    Contoh:

    Route::get('/admin')
        ->middleware('role:admin');


    Nah, parameter admin bisa diterima middleware.

    Cara Buat Middleware Parameter
    public function handle($request, Closure $next, $role)
    {
        if (auth()->user()->role !== $role) {
            abort(403);
        }

        return $next($request);
    }


    Sekarang middleware bisa fleksibel.

    
    
    
    
    
    
    
    ğŸ”¥ 4ï¸âƒ£ Multiple Middleware

    Kamu bisa pakai lebih dari satu:

    Route::get('/admin')
        ->middleware(['auth', 'role:admin']);


    Urutannya:

    auth

    role

    Kalau auth gagal â†’ role tidak dijalankan.

    
    
    
    
    
    
    
    ğŸ§± 5ï¸âƒ£ Global Middleware

    Ada middleware yang berjalan di semua request.

    Lihat di:

    app/Http/Kernel.php


    Di bagian:

    protected $middleware = [
        ...
    ];


    Contoh bawaan:

    Cek maintenance mode

    Trim input

    Convert empty string to null

    Global middleware berjalan sebelum route diproses.

    
    
    
    
    
    
    
    ğŸ”¥ 6ï¸âƒ£ Middleware Group

    Di Kernel.php ada:

    protected $middlewareGroups = [
        'web' => [...],
        'api' => [...],
    ];


    Group web biasanya berisi:

    Session

    CSRF

    Cookie

    Share errors

    Kalau route di web.php, otomatis pakai group web.

    
    
    
    
    
    
    
    ğŸ§  7ï¸âƒ£ Terminable Middleware (Advanced)

    Middleware bisa punya method tambahan:

    public function terminate($request, $response)
    {
        // dijalankan setelah response dikirim
    }


    Biasanya dipakai untuk:

    Logging

    Tracking

    Analytics

    User sudah dapat response,
    tapi middleware masih bisa jalan.

    
    
    
    
    
    
    
    ğŸ¯ Gambaran Besar Alur Middleware
    Global Middleware
        â†“
    Middleware Group (web/api)
        â†“
    Route Middleware
        â†“
    Controller
        â†“
    Response kembali lewat middleware


    Middleware itu seperti lapisan-lapisan bawang ğŸ§…

    
    
    
    
    
    
    
    ğŸ§  Kapan Middleware Dipakai?

    Gunakan middleware untuk:

    âœ… Cek login
    âœ… Cek role
    âœ… Cek subscription
    âœ… Rate limiting
    âœ… Logging request
    âœ… Cek header
    âœ… Cek token

    Jangan pakai middleware untuk:
    âŒ Logic bisnis berat
    âŒ Query database kompleks berlebihan

    
    
    
    
    
    
    
    âš  Kesalahan Umum Pemula

    âŒ Tidak return $next($request)
    âŒ Taruh logic berat di middleware
    âŒ Tidak paham urutan middleware
    âŒ Hardcode terlalu banyak

    
    
    
    
    
    
    
    ğŸ Kesimpulan Middleware Lanjutan

    Sekarang kamu paham bahwa middleware bisa:

    Jalan sebelum controller

    Jalan setelah controller

    Punya parameter

    Digunakan berlapis

    Global atau per route

    Bahkan jalan setelah response dikirim

    Ini sudah masuk ke arsitektur internal Laravel ğŸ”¥
</pre>

            </div>
        </main>
    </div>
    <script>
        fetch('layout/aside.html').then( response => response.text()).then( data => {
            document.getElementById('aside').innerHTML = data;

            const currentPage = window.location.pathname.split('/').pop() || 'index.html';
            const links = document.querySelectorAll('aside a');

            links.forEach(link => {
                if(currentPage == 'index.html'){
                    document.getElementById('1-1-php-dasar').classList.add('active');
                } else if(link.getAttribute('href') == currentPage){
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>